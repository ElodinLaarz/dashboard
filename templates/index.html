<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Item Dashboard</title>
    <script src="/static/htmx.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            color: white;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .instructions {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .instructions h2 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 1.5em;
        }

        .instructions p {
            color: #555;
            line-height: 1.6;
        }

        .instructions .reset-btn {
            margin-top: 15px;
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .instructions .reset-btn:hover {
            background: #764ba2;
            transform: scale(1.05);
        }

        #items-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .item {
            padding: 30px 20px;
            border-radius: 15px;
            background: white;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            text-align: center;
            position: relative;
        }

        .item.matched {
            box-shadow: 0 8px 16px rgba(102, 126, 234, 0.4);
            transform: scale(1.02);
        }

        .item-id {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 15px;
            color: #333;
        }

        .item-property {
            margin: 8px 0;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 500;
            display: inline-block;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            border: 2px solid transparent;
        }

        .item-property:hover {
            transform: scale(1.1);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .item-property.active {
            border: 2px solid currentColor;
            font-weight: 700;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
        }

        .color-badge {
            background: #e3f2fd;
            color: #1976d2;
        }

        .shape-badge {
            background: #f3e5f5;
            color: #7b1fa2;
        }

        .category-badge {
            background: #e8f5e9;
            color: #388e3c;
        }

        /* Color-specific styling */
        .item.blue {
            border-left: 5px solid #2196F3;
        }

        .item.red {
            border-left: 5px solid #f44336;
        }

        .item.green {
            border-left: 5px solid #4CAF50;
        }

        /* Shape indicators */
        .shape-indicator {
            width: 40px;
            height: 40px;
            margin: 10px auto;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .shape-indicator.square {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 5px;
        }

        .shape-indicator.circle {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 50%;
        }

        .shape-indicator.triangle {
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-bottom: 35px solid #4facfe;
            background: none;
        }

        .htmx-swapping .item {
            opacity: 0;
            transform: scale(0.8);
        }

        .htmx-settling .item {
            opacity: 1;
            transform: scale(1);
        }

        .htmx-added {
            animation: fadeInUp 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        #active-filter {
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            display: none;
        }

        #active-filter.show {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        #active-filter .filter-label {
            color: #667eea;
            font-weight: 600;
            font-size: 1.1em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸŽ¨ Interactive Item Dashboard</h1>
        
        <div class="instructions">
            <h2>How to Use</h2>
            <p>Click on any property tag (color, shape, or category) to group items by that property. Items with matching properties will animate to the front of the grid. Click the reset button below to return to the original order.</p>
            <button class="reset-btn" 
                    hx-get="/items" 
                    hx-target="#items-container" 
                    hx-swap="innerHTML swap:300ms"
                    onclick="clearActiveFilter()">Reset View</button>
        </div>

        <div id="active-filter">
            <span class="filter-label">Grouped by: <span id="filter-text"></span></span>
        </div>

        <div id="items-container">
            {{range .Items}}
            <div class="item {{.Color}}">
                <div class="item-id">Item #{{.ID}}</div>
                <div class="shape-indicator {{.Shape}}"></div>
                <div class="item-property color-badge" 
                     hx-get="/items?filterBy=color&filterValue={{.Color}}"
                     hx-target="#items-container"
                     hx-swap="innerHTML swap:400ms settle:600ms"
                     onclick="setActiveFilter('color', '{{.Color}}')">
                    {{.Color}}
                </div>
                <div class="item-property shape-badge" 
                     hx-get="/items?filterBy=shape&filterValue={{.Shape}}"
                     hx-target="#items-container"
                     hx-swap="innerHTML swap:400ms settle:600ms"
                     onclick="setActiveFilter('shape', '{{.Shape}}')">
                    {{.Shape}}
                </div>
                <div class="item-property category-badge" 
                     hx-get="/items?filterBy=category&filterValue={{.Category}}"
                     hx-target="#items-container"
                     hx-swap="innerHTML swap:400ms settle:600ms"
                     onclick="setActiveFilter('category', '{{.Category}}')">
                    {{.Category}}
                </div>
            </div>
            {{end}}
        </div>
    </div>

    <script>
        function setActiveFilter(type, value) {
            const filterDiv = document.getElementById('active-filter');
            const filterText = document.getElementById('filter-text');
            filterText.textContent = `${type}: ${value}`;
            filterDiv.classList.add('show');
            
            // Remove active class from all badges
            document.querySelectorAll('.item-property').forEach(el => {
                el.classList.remove('active');
            });
            
            // Add active class to clicked badge
            event.target.classList.add('active');
        }
        
        function clearActiveFilter() {
            const filterDiv = document.getElementById('active-filter');
            filterDiv.classList.remove('show');
            
            // Remove active class from all badges
            document.querySelectorAll('.item-property').forEach(el => {
                el.classList.remove('active');
            });
        }
    </script>
</body>
</html>
